(window.webpackJsonp=window.webpackJsonp||[]).push([[470],{809:function(s,n,e){"use strict";e.r(n);var t=e(7),a=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"宏任务与微任务的执行顺序"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#宏任务与微任务的执行顺序"}},[s._v("#")]),s._v(" 宏任务与微任务的执行顺序")]),s._v(" "),n("h2",{attrs:{id:"_1-宏任务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-宏任务"}},[s._v("#")]),s._v(" 1.宏任务")]),s._v(" "),n("p",[s._v("是指消息队列中的等待被主线程执行的事件，宏任务执行时都会重新创建栈，然后调用宏任务中的函数，栈也会随着变化，但宏任务执行结束时，栈也会随之销毁。")]),s._v(" "),n("p",[s._v("包括 整体代码script，setTimeout，setInterval ，setImmediate，I/O，UI renderingnew ，Promise*")]),s._v(" "),n("h2",{attrs:{id:"_2-微任务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-微任务"}},[s._v("#")]),s._v(" 2.微任务")]),s._v(" "),n("p",[s._v("可以把微任务看成是一个需要异步执行的函数，"),n("strong",[n("strong",[s._v("执行时机是在主函数执行结束之后、当前宏任务结束之前")])])]),s._v(" "),n("p",[s._v("包括 Promises.(then catch finally)，process.nextTick， MutationObserver")]),s._v(" "),n("p",[s._v("微任务是基于消息队列、事件循环、UI 主线程还有堆栈而来的\n")]),s._v(" "),n("h2",{attrs:{id:"_3-执行顺序"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-执行顺序"}},[s._v("#")]),s._v(" 3.执行顺序")]),s._v(" "),n("p",[s._v("宏任务和微任务的区别在于在事件循环机制中，执行的机制不同")]),s._v(" "),n("p",[s._v("每次执行完所有的同步任务后，会在任务队列中取出异步任务，先将所有微任务执行完成后，才会执行宏任务\n所以可以得出结论， 微任务会在宏任务之前执行。\n我们在工作常用到的宏任务是 setTimeout，而微任务是 Promise.then")]),s._v(" "),n("p",[s._v("注意这里是Promise.then,也就是说 new Promise在实例化的过程中所执行的代码是同步的，而在 then中注册的回调函数才是异步。")]),s._v(" "),n("h2",{attrs:{id:"例子"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#例子"}},[s._v("#")]),s._v(" 例子")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("setTimeout(function(){\n    console.log('1')\n});\nnew Promise(function(resolve){\n    console.log('2');\n    resolve();\n}).then(function(){\n    console.log('3')\n});\nconsole.log('4');\nnew Promise(function(resolve){\n    console.log('5');\n    resolve();\n}).then(function(){\n    console.log('6')\n});\nsetTimeout(function(){\n    console.log('7')\n});\nfunction bar(){\n    console.log('8')\n    foo()\n}\nfunction foo(){\n    console.log('9')\n}\nconsole.log('10')\nbar()\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("p",[s._v("最终结果：2，4，5，10，8，9，3，6，1，7")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/plBlog/p/14333628.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考文档"),n("OutboundLink")],1)])])}),[],!1,null,null,null);n.default=a.exports}}]);