(window.webpackJsonp=window.webpackJsonp||[]).push([[135],{473:function(s,n,a){"use strict";a.r(n);var t=a(7),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'open the .xls file Option Explicit  ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Const")]),s._v(" MSEXCEL_FILENAME "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Excel文件路径"')]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" VBMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'加快运行速度，暂停表格刷新和禁止弹出框。 ")]),s._v("\n    Application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ScreenUpdating "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v(" \n    Application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DisplayAlerts "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("    \n    \n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'遍历每个sheet              ")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" xlApp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" WorkBooks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Sheet  \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" xlApp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" WSH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CreateObject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Excel.Application"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" more "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        xlApp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Visible "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("  \n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" WorkBooks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" xlApp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Workbooks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Open"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MSEXCEL_FILENAME"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   \n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" Sheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" WorkBooks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'打开第一个工作表  ")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' 也可以打开上次保存时打开的活动工作表  ")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' Set Sheet = WorkBooks.ActiveSheet  打开活动的工作表   ")]),s._v("\n                WorkBooks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Close \n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sub")]),s._v("    \n            \n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'select data ")]),s._v("\n            Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"G:G"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("    \n            Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter    \n                ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$G$1:$G$200"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter Field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Criteria1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fail"')]),s._v("   \n                \n                \n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'copy and paste data to other sheet    ")]),s._v("\n                ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$G$1:$G$200"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter Field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Criteria1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"电声工程师"')]),s._v("    \n                Rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2:2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("    \n                    Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Copy    \n                    Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("    \n                        Rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1:1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EntireRow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFit    \n                        Rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1:1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("    \n                            ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Paste \n                            \n                            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获取当前sheet页的名称  ")]),s._v("\n                            fname "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name     \n                            \n                            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'get the end of excel ")]),s._v("\n                            Sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UsedRange"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Count或者Sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UsedRange"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Columns"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Count\n                            Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yue"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UsedRange"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Count\n                            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'choose entire columns")]),s._v("\n                            Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EntireColumn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n                                 Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EntireRow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br")])]),n("p",[s._v("activecell.address'这是当前单元格地址\nselection.offset(1, 0).select'这是向下跳1格\nselection.offset(-1, 0).select'这是向上跳1格\nselection.offset(0, -1).select'这是向左跳1格\nselection.offset(0, 1).select'这是向右跳1格")]),s._v(" "),n("p",[s._v("1.搜索表中的内容并且获得位置")]),s._v(" "),n("p",[s._v("1.缺少遍历所有sheet")]),s._v(" "),n("p",[s._v("2.将参数设置成变量")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" 全套服务连续版本"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' 全套服务连续版本 宏")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'创建新sheet 宏")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("dim")]),s._v(" resultSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("dim")]),s._v(" searchResultLocation "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("string")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("dim")]),s._v(" sheetCopyRange "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("string")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("dim")]),s._v(" sheetPasteRange "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("string")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("dim")]),s._v(" currentSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("string")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("dim")]),s._v(" colmunsCount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("dim")]),s._v(" rowsCount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'新建一个sheet存放失败项")]),s._v("\n    Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Add After"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ActiveSheet\n    Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet3"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n    Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet3"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),s._v("\n        \n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'begin to lookup")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'查找Result行并获取result行的位置")]),s._v("\n    Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("What"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Result"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" After"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LookIn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlFormulas"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LookAt "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlPart"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchOrder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlByRows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchDirection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlNext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MatchCase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MatchByte"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchFormat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Activate\n        \n    \tsearchResultLocation "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        CONSTCOLUMNS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Left"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("searchResultLocation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"800"')]),s._v("\n        Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EntireColumn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n            \n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'search reasult and get the location，filter the Fail data")]),s._v("\n    \tSelection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter\n        ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("searchResultLocation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlDown"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter Field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Criteria1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Fail"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'选择有效数据")]),s._v("\n    \tActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SpecialCells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlCellTypeConstants"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'复制粘贴到新的表格")]),s._v("\n        Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Copy\n    \tSheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n        Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A65536"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Row "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\t\tActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Paste\n                \n    \tRange"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A14"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n        Application"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CutCopyMode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n        ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("FormulaR1C1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"AVCVBS"')]),s._v("\n        Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFill Destination"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A14:A24"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlFillDefault\n        Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A14:A24"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n        Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"F20"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n                                \n                                \n                                \n                                \n                                \n                                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'get cell's address")]),s._v("\n\tF_Max_Range "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("           "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获得单元格的地址，形式为$A$1")]),s._v("\n       F_Max_Range "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获得单元格的地址，形式为A1")]),s._v("\n   F_Max_Range "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获得单元格的地址，形式为$A1")]),s._v("\n   F_Max_Range "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获得单元格的地址，形式为A$1")]),s._v("\n   F_Max_Range "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获得单元格的地址，形式为$A$1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br")])]),n("p",[s._v("Dim CONSTCOLUMNS As String")]),s._v(" "),n("p",[s._v("'\nDim searchResultLocation As String")]),s._v(" "),n("p",[s._v('Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\nFalse, MatchByte:=False, SearchFormat:=False).Activate\nsearchResultLocation = ActiveCell.Address(0, 0)\nCONSTCOLUMNS = Left(searchResultLocation, 1) + "1000"\nSelection.EntireColumn.Select\nActiveSheet.Colmuns(searchResultLocation, CONSTCOLUMNS).Select')]),s._v(" "),n("h4",{attrs:{id:"获取最后一行"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取最后一行"}},[s._v("#")]),s._v(" 获取最后一行")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(" '为最后一个单元格所在行 , 即最后一行,该函数表示Sheet表的使用区域中的最后一行\n    nLastUseRow = Cells.SpecialCells(xlCellTypeLastCell).Row\n\n\n    ' 得到A列单元格的最后一行\n    strCell = \"A\" + CStr(nLastUseRow + 1)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v('ActiveCell.Address(0, 0) & Left(searchResultLocation, 1) + "800"')]),s._v(" "),n("h1",{attrs:{id:"excel表格不是从第一行开始的-也不是隐藏"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#excel表格不是从第一行开始的-也不是隐藏"}},[s._v("#")]),s._v(" excel表格不是从第一行开始的，也不是隐藏")]),s._v(" "),n("p",[s._v("冻结窗口了")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("Sub SetCursorToCell(iRow As Integer, iCol As Integer)\n    Dim pt As POINTAPI\n    Dim iTRow As Integer\n    Dim iTCol As Integer\n\n    iTRow = ActiveWindow.VisibleRange.Rows.Count\n    iTCol = ActiveWindow.VisibleRange.Columns.Count\n   \n    If iRow < ActiveWindow.VisibleRange.Row Or iRow > ActiveWindow.VisibleRange.Row + iTRow - 1 Or iCol < ActiveWindow.VisibleRange.Column Or iCol > ActiveWindow.VisibleRange.Column + iTCol - 1 Then\n        Cells(iRow, iCol).Select\n    End If\n   \n    pt.x = ActiveWindow.PointsToScreenPixelsX(0) + _\n        Point2PixelX(Cells(iRow, iCol).Left)\n    pt.y = ActiveWindow.PointsToScreenPixelsY(0) + _\n        Point2PixelX(Cells(iRow, iCol).Top)\n    SetCursorPos pt.x, pt.y\nEnd Sub\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("Direction XlDirection 类型，必需。所要移动的方向。")]),s._v(" "),n("p",[s._v("XlDirection 可为 XlDirection 常量之一。")]),s._v(" "),n("p",[s._v("xlDown")]),s._v(" "),n("p",[s._v("xlToRight")]),s._v(" "),n("p",[s._v("xlToLeft")]),s._v(" "),n("p",[s._v("xlUp")]),s._v(" "),n("p",[s._v("二、End(xlUp).Row示例")]),s._v(" "),n("p",[s._v("本示例选定包含单元格 B4 的区域中 B 列顶端的单元格。")]),s._v(" "),n("p",[s._v('Range("B4").End(xlUp).Select')]),s._v(" "),n("p",[s._v("本示例选定包含单元格 B4 的区域中第 4 行尾端的单元格。")]),s._v(" "),n("p",[s._v('Range("B4").End(xlToRight).Select')]),s._v(" "),n("h1",{attrs:{id:"版本1-0"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#版本1-0"}},[s._v("#")]),s._v(" 版本1.0")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'20201104 1521V1.0  ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'能对单个表进行操作，缺少遍历")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'多重区域选定会出bug")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'优化：可以，没能插入表名称")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' test2 宏")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" resultSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" searchResultLocation "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sheetCopyRange "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sheetPasteRange "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" currentSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" colmunsCount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" rowsCount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'新建一个sheet存放失败项")]),s._v("\n   \n    \n    \n    \n   Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("What"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Result"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" After"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LookIn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlFormulas"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LookAt "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlPart"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchOrder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlByRows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchDirection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlNext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MatchCase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MatchByte"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchFormat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Activate\n        \n          searchResultLocation "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n          \n          \n        CONSTCOLUMNS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Left"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("searchResultLocation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"800"')]),s._v("\n        \n        Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EntireColumn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n            \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'search reasult and get the location")]),s._v("\n    Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter\n    ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("searchResultLocation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlDown"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter Field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Criteria1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Fail"')]),s._v("\n          \n         ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SpecialCells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlCellTypeConstants"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         \n         Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Copy\n         Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         \n         Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlUp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Row "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Paste\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("p",[n("strong",[s._v("版本2.0")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("'添加注释\nSub test2()\n'\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n' test2 宏\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    Dim currentSheetName As String\n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    \n    '新建一个sheet存放失败项\n   \n    \n        '获取表名字\n        fname = ActiveSheet.Name\n        '搜索并确定result位置\n         Cells.Find(What:=\"Result\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n          \n        CONSTCOLUMNS = Left(searchResultLocation, 1) + \"800\"\n        \n        Selection.EntireColumn.Select\n            \n    '对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:=\"Fail\"\n          \n         ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         '复制粘贴到新的表\n         Selection.Copy\n         Sheets(\"failResult\").Select\n         '插入新得行再复制粘贴\n         Range(\"a\" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         ActiveSheet.Paste\n         \n          '选择有效数据\n      \nEnd Sub\n\n\n\n\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br")])]),n("h3",{attrs:{id:"版本3-0"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#版本3-0"}},[s._v("#")]),s._v(" 版本3.0")]),s._v(" "),n("p",[s._v("能够遍历")]),s._v(" "),n("p",[s._v("不能写名字")]),s._v(" "),n("p",[s._v("能够复制")]),s._v(" "),n("p",[s._v("不能重复选")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("Sub 宏1()\n'添加注释\n\n'\n  \n' test2 宏\n'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    Dim currentSheetName As Excel.Worksheet\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    \n    '新建一个sheet存放失败项\n   '获取脚本数量\n   ' sheetCount = Worksheets.Count\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n    \n        \n        '获取表名字\n       ' fname = ActiveSheet.Name\n        '搜索并确定result位置\n         activesheet.Cells.Find(What:=\"Result\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n          \n        CONSTCOLUMNS = Left(searchResultLocation, 1) + \"800\"\n        \n        Selection.EntireColumn.Select\n            \n    '对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:=\"Fail\"\n          \n         ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         '复制粘贴到新的表\n         Selection.Copy\n         Sheets(\"failResult\").Select\n         '到最后一格空格处复制粘贴防止覆盖\n         Range(\"a\" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          '选择有效数据\n      \nNext\nEnd Sub\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br")])]),n("h4",{attrs:{id:"版本4-0"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#版本4-0"}},[s._v("#")]),s._v(" 版本4.0")]),s._v(" "),n("p",[s._v("需要判断是否有fail项目，如果没有就跳出")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("\nSub 宏1()\n'添加注释\n\n'\n  \n' test2 宏\n'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    Dim currentSheetName As Excel.Worksheet\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    \n    '新建一个sheet存放失败项\n   '获取脚本数量\n   ' sheetCount = Worksheets.Count\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n        MsgBox currentSheetName.Name\n        \n        '获取表名字\n       ' fname = ActiveSheet.Name\n        '搜索并确定result位置\n         ActiveSheet.Cells.Find(What:=\"Result\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n          \n        CONSTCOLUMNS = Left(searchResultLocation, 1) + \"800\"\n        \n        Selection.EntireColumn.Select\n            \n    '对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:=\"Fail\"\n          \n         ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         '复制粘贴到新的表\n         Selection.Copy\n         Sheets(\"failResult\").Select\n         '到最后一格空格处复制粘贴防止覆盖\n         Range(\"a\" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          '选择有效数据\n      \nNext\n\n\nEnd Sub\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br")])]),n("h4",{attrs:{id:"版本5-0"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#版本5-0"}},[s._v("#")]),s._v(" 版本5.0")]),s._v(" "),n("div",{staticClass:"language-vb line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" failResult"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'添加注释")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'")]),s._v("\n  \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' test2 宏")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Dim sheetCount As Integer")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" resultSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" searchResultLocation "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sheetCopyRange "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sheetPasteRange "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" currentSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Excel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheet\n    \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" colmunsCount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" rowsCount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'判断是否存在failResult文件夹")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Each")]),s._v(" currentSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" ThisWorkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheets\n    \n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" currentSheetName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n            Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Add After"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ActiveSheet\n            Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n            Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n        \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v(" currentSheetName\n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'新建一个sheet存放失败项")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获取脚本数量")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' sheetCount = Worksheets.CountNew")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Each")]),s._v(" currentSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" ThisWorkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheets\n    \n\n        \n        MsgBox currentSheetName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name\n        \n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获取表名字")]),s._v("\n       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' fname = ActiveSheet.Name")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'搜索并确定result位置")]),s._v("\n         ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("What"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Result"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" After"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LookIn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlFormulas"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LookAt "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlPart"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchOrder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlByRows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchDirection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlNext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MatchCase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MatchByte"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchFormat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Activate\n          searchResultLocation "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n          \n          \n        CONSTCOLUMNS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Left"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("searchResultLocation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"800"')]),s._v("\n        \n        Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EntireColumn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n            \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'对选中数据进行筛选")]),s._v("\n    Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter\n    ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("searchResultLocation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlDown"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter Field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Criteria1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Fail"')]),s._v("\n          \n         ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SpecialCells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlCellTypeConstants"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'复制粘贴到新的表")]),s._v("\n         Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Copy\n         Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'到最后一格空格处复制粘贴防止覆盖")]),s._v("\n         Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlUp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Row "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         \n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Rows(ActiveSheet.UsedRange.Rows.Count).Insert")]),s._v("\n         \n         ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Paste\n         \n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'colmunsCount = ActiveSheet.UsedRange.Columns.Count")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'rowsCount = ActiveSheet.UsedRange.Rows.Count")]),s._v("\n         \n         \n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'ActiveSheet(failResult).Range().Values = currentSheetName")]),s._v("\n         \n         \n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'选择有效数据")]),s._v("\n      \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br")])]),n("p",[s._v("版本V6.0")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('Sub 脚本命令()\n\n\n\'添加注释\n\n\'\n  \n\' test2 宏\n\'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n        \'判断是否存在failResult文件夹\n        s = "failResult"\n        Set judge = CreateObject("Scripting.Dictionary")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = ""\n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n            Sheets.Add After:=ActiveSheet\n            Sheets("Sheet1").Select\n            Sheets("Sheet1").Name = "failResult"\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    \'新建一个sheet存放失败项\n   \'获取脚本数量\n   \' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n\n        \n        MsgBox currentSheetName.Name\n        \n        \'获取表名字\n       \' fname = ActiveSheet.Name\n        \'搜索并确定result位置\n         ActiveSheet.Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n          \n        CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"\n        \n        Selection.EntireColumn.Select\n            \n    \'对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:="Fail"\n          \n         ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         \'复制粘贴到新的表\n         Selection.Copy\n         Sheets("failResult").Select\n         \'到最后一格空格处复制粘贴防止覆盖\n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         \'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         \'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         \'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         \'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          \'选择有效数据\n      \nNext\n\n\n\'\nEnd Sub\n\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br")])]),n("p",[s._v("版本v7.0")]),s._v(" "),n("div",{staticClass:"language-VB line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vb"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" 脚本命令"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'添加注释")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'")]),s._v("\nApplication"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DisplayAlerts "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n  \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' test2 宏")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Dim sheetCount As Integer")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" resultSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" searchResultLocation "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sheetCopyRange "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" sheetPasteRange "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" judge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" currentSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" Excel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" s"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("\n    \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" colmunsCount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" rowsCount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'判断是否存在failResult文件夹")]),s._v("\n        s "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" judge "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CreateObject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scripting.Dictionary"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Each")]),s._v(" currentResultName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" Worksheets\n        judge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("currentResultName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n        \n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" judge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exists"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" begin\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Else")]),s._v("\n            Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Add After"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ActiveSheet\n            Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n            Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" judge "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("Nothing")]),s._v("\n        \nbegin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'新建一个sheet存放失败项")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获取脚本数量")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' sheetCount = Worksheets.CountNew")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Each")]),s._v(" currentSheetName "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" ThisWorkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Worksheets\n    \n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" currentSheetName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" nexttime\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n        \n        \n        \n        MsgBox currentSheetName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name\n        \n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'获取表名字")]),s._v("\n       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("' fname = ActiveSheet.Name")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'搜索并确定result位置")]),s._v("\n         ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("What"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Result"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" After"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LookIn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlFormulas"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LookAt "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlPart"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchOrder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlByRows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchDirection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xlNext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MatchCase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MatchByte"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SearchFormat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Activate\n          searchResultLocation "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ActiveCell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n          \n          \n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('\'CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"')]),s._v("\n        \n        Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EntireColumn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n            \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'对选中数据进行筛选")]),s._v("\n    Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter\n    ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("searchResultLocation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlDown"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AutoFilter Field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Criteria1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Fail"')]),s._v("\n          \n         ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SpecialCells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlCellTypeConstants"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'复制粘贴到新的表")]),s._v("\n         Selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Copy\n         Sheets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failResult"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'到最后一格空格处复制粘贴防止覆盖")]),s._v("\n         Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlUp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Row "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         \n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Rows(ActiveSheet.UsedRange.Rows.Count).Insert")]),s._v("\n         \n         ActiveSheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Paste\n         Range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlUp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Row "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n         \n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'colmunsCount = ActiveSheet.UsedRange.Columns.Count")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'rowsCount = ActiveSheet.UsedRange.Rows.Count")]),s._v("\n         \n         \n         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'ActiveSheet(failResult).Range().Values = currentSheetName")]),s._v("\n         \n         \n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'选择有效数据")]),s._v("\nnexttime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br")])]),n("p",[s._v("版本V9.0")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("Sub 脚本命令()\n\n\n'添加注释\nApplication.ScreenUpdating = False\n'\nApplication.DisplayAlerts = False\n  \n' test2 宏\n'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    'fail result name\n    Dim FRN As String\n        '判断是否存在failResult文件夹\n         FRN = \"failResult\"\n        s = \"failResult\"\n        Set judge = CreateObject(\"Scripting.Dictionary\")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = \"\"\n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        MsgBox \"请创建一个名为failResult的工作表\"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    '新建一个sheet存放失败项\n   '获取脚本数量\n   ' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        End If\n        \n        \n        \n        MsgBox currentSheetName.Name\n        \n        '获取表名字\n       ' fname = ActiveSheet.Name\n        '搜索并确定result位置\n         ActiveSheet.Cells.Find(What:=\"Result\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n          \n        'CONSTCOLUMNS = Left(searchResultLocation, 1) + \"800\"\n        \n        Selection.EntireColumn.Select\n            \n    '对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:=\"Fail\"\n          \n         ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         '复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         '到最后一格空格处复制粘贴防止覆盖\n         Range(\"a\" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         Range(\"a\" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          '选择有效数据\nnexttime:\nNext\n\n\n'\nEnd Sub\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br")])]),n("p",[s._v("版本V10.0")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('Sub 宏1()\n\n\n\n\'添加注释\nApplication.ScreenUpdating = False\n\'\nApplication.DisplayAlerts = False\n  \n\' test2 宏\n\'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    \'fail result name\n    Dim FRN As String\n        \'判断是否存在failResult文件夹\n         FRN = "failResult"\n        s = "failResult"\n        Set judge = CreateObject("Scripting.Dictionary")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = ""\n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        MsgBox "请创建一个名为failResult的工作表"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    \'新建一个sheet存放失败项\n   \'获取脚本数量\n   \' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        MsgBox "failresult"\n        End If\n        \n        \n        \n        MsgBox currentSheetName.Name\n        \n        \'获取表名字\n       \' fname = ActiveSheet.Name\n        \'搜索并确定result位置\n         ActiveSheet.Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n          \n        \'CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"\n        \n        Selection.EntireColumn.Select\n            \n    \'对选中数据进行筛选\n        Selection.AutoFilter\n        ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:="Fail"\n          \n         ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         \'复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         \'到最后一格空格处复制粘贴防止覆盖\n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n         \n         \'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n         \n         \'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         \'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         \'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          \'选择有效数据\n          MsgBox "执行完一次"\nnexttime:\nNext\n\n\n\'\nEnd Sub\n\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br")])]),n("p",[s._v("v11.0")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("'Private Declare Sub Sleep Lib \"kernel32.dll\" (ByVal dwMilliseconds As Long)\nSub 宏1()\n\n\n\n'添加注释\nApplication.ScreenUpdating = False\n'\nApplication.DisplayAlerts = False\n  \n' test2 宏\n'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    'fail result name\n    Dim FRN As String\n        '判断是否存在failResult文件夹\n         FRN = \"failResult\"\n        s = \"failResult\"\n        Set judge = CreateObject(\"Scripting.Dictionary\")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = \"\"\n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        MsgBox \"请创建一个名为failResult的工作表\"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    '新建一个sheet存放失败项\n   '获取脚本数量\n   ' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        End If\n        \n        Sheets(currentSheetName.Name).Select\n        \n        MsgBox currentSheetName.Name\n        \n        '获取表名字\n       ' fname = ActiveSheet.Name\n        '搜索并确定result位置\n         ActiveSheet.Cells.Find(What:=\"Result\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n        '等待一段时间再执行\n        'Application.Wait Now + TimeValue(\"00:00:01\")\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n          \n        'CONSTCOLUMNS = Left(searchResultLocation, 1) + \"800\"\n        \n        Selection.EntireColumn.Select\n            \n    '对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:=\"Fail\"\n    \n          'Application.Wait Now + TimeValue(\"00:00:01\")\n          \n         ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         '复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         '到最后一格空格处复制粘贴防止覆盖\n         Range(\"a\" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         'Application.Wait Now + TimeValue(\"00:00:01\")\n         'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         'Range(\"a\" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          '选择有效数据\nnexttime:\nNext\n\n\n'\nEnd Sub\n\n\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br")])]),n("p",[s._v("版本V12")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\'Private Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long)\nSub 宏1()\n\n\n\n\'添加注释\nApplication.ScreenUpdating = False\n\'\nApplication.DisplayAlerts = False\n  \n\' test2 宏\n\'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    \'fail result name\n    Dim FRN As String\n        \'判断是否存在failResult文件夹\n         FRN = "failResult"\n        s = "failResult"\n        Set judge = CreateObject("Scripting.Dictionary")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = ""\n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        MsgBox "请创建一个名为failResult的工作表"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    \'新建一个sheet存放失败项\n   \'获取脚本数量\n   \' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        End If\n        \n        Sheets(currentSheetName.Name).Select\n        Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n        \n        \n        \n        MsgBox currentSheetName.Name\n        \n        \'获取表名字\n       \' fname = ActiveSheet.Name\n        \'搜索并确定result位置\n         ActiveSheet.Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n        \'等待一段时间再执行\n        \'Application.Wait Now + TimeValue("00:00:01")\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n        \n          \n        \'CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"\n        \n        Selection.EntireColumn.Select\n            \n    \'对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:="Fail"\n    \n          \'Application.Wait Now + TimeValue("00:00:01")\n          \n         ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         \'复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         \'到最后一格空格处复制粘贴防止覆盖\n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n         \'Application.Wait Now + TimeValue("00:00:01")\n         \'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         \'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         \'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         \'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          \'选择有效数据\nnexttime:\nNext\n\n\n\'\nEnd Sub\n\n\n\n\n\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br")])]),n("p",[s._v("若要对一个可能包含多重选定区域的区域使用此属性，请用 Areas.Count 方法测试一下此区域内是否包含多个子区域。如果确实包含多个子区域，可对此区域内的每一子区域进行循环。")]),s._v(" "),n("p",[s._v("V13.0")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\'Private Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long)\nSub 宏1()\n\n\n\n\'添加注释\nApplication.ScreenUpdating = False\n\'\nApplication.DisplayAlerts = False\n  \n\' test2 宏\n\'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    \'fail result name\n    Dim FRN As String\n        \'判断是否存在failResult文件夹\n         FRN = "failResult"\n        s = "failResult"\n        Set judge = CreateObject("Scripting.Dictionary")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = ""\n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        MsgBox "请创建一个名为failResult的工作表"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    \'新建一个sheet存放失败项\n   \'获取脚本数量\n   \' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        End If\n        \n        Sheets(currentSheetName.Name).Select\n        Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n        ActiveSheet.UsedRange.AutoFilter\n        \n        \n        MsgBox currentSheetName.Name\n        \n        \'获取表名字\n       \' fname = ActiveSheet.Name\n        \'搜索并确定result位置\n         ActiveSheet.Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n        \'等待一段时间再执行\n        \'Application.Wait Now + TimeValue("00:00:01")\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n        \n          \n        \'CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"\n        \n        Selection.EntireColumn.Select\n            \n    \'对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:="Fail"\n    \n          \'Application.Wait Now + TimeValue("00:00:01")\n          \n         ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         \'复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         \'到最后一格空格处复制粘贴防止覆盖\n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n         \'Application.Wait Now + TimeValue("00:00:01")\n         \'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         \'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         \'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         \'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          \'选择有效数据\nnexttime:\nNext\n\n\n\'\nEnd Sub\n\n\n\n\n\n\n\n\n\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br")])]),n("h1",{attrs:{id:"v15-202011051606-可用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#v15-202011051606-可用"}},[s._v("#")]),s._v(" V15（202011051606  可用）")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\'Private Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long)\nSub 宏1()\n\n\n\n\'添加注释\nApplication.ScreenUpdating = False\n\'\nApplication.DisplayAlerts = False\n  \n\' test2 宏\n\'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    \'fail result name\n    Dim FRN As String\n        \'判断是否存在failResult文件夹\n         FRN = "failResult"\n        s = "failResult"\n        Set judge = CreateObject("Scripting.Dictionary")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = ""\n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        \'MsgBox "请创建一个名为failResult的工作表"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    \'新建一个sheet存放失败项\n   \'获取脚本数量\n   \' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        End If\n        \n        Sheets(currentSheetName.Name).Select\n        Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n        ActiveSheet.UsedRange.AutoFilter\n        \n        \n       \' MsgBox currentSheetName.Name\n        \n        \'获取表名字\n       \' fname = ActiveSheet.Name\n        \'搜索并确定result位置\n         ActiveSheet.Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n        \'等待一段时间再执行\n        \'Application.Wait Now + TimeValue("00:00:01")\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n        \n          \n        \'CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"\n        \n        Selection.EntireColumn.Select\n            \n    \'对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:="Fail"\n    \n          \'Application.Wait Now + TimeValue("00:00:01")\n          \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 3).Select\n         \n        \n         \'ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         \n         Sheets(currentSheetName.Name).Range("a1").CurrentRegion.Select\n         \'复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         \'到最后一格空格处复制粘贴防止覆盖\n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n         \'Application.Wait Now + TimeValue("00:00:01")\n         \'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         \'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         \'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         \'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          \'选择有效数据\nnexttime:\nNext\n\nMsgBox "所有失败项都已放置在failResult中"\n\nEnd Sub\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br")])]),n("h1",{attrs:{id:"v17-0-不可用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#v17-0-不可用"}},[s._v("#")]),s._v(" V17.0（不可用）")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\'Private Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long)\nSub 宏1()\n\n\n\n\'添加注释\nApplication.ScreenUpdating = False\n\'\nApplication.DisplayAlerts = False\n  \n\' test2 宏\n\'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    \'fail result name\n    Dim FRN As String\n        \'判断是否存在failResult文件夹\n         FRN = "failResult"\n        s = "failResult"\n        Set judge = CreateObject("Scripting.Dictionary")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = ""\n        \n        \'判断是否有空表，有则删除\n        If IsBlankSht(currentSheetName) Then\n        currentSheetName.Delete\n        End If\n        \n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        \'MsgBox "请创建一个名为failResult的工作表"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    \'新建一个sheet存放失败项\n   \'获取脚本数量\n   \' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n        \n        \n        \n    \n        \n        \'不对failResult进行操作\n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        End If\n        \n        \n        Sheets(currentSheetName.Name).Select\n        Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n        ActiveSheet.UsedRange.AutoFilter\n        \n        \n       \' MsgBox currentSheetName.Name\n        \n        \'获取表名字\n       \' fname = ActiveSheet.Name\n        \'搜索并确定result位置\n         ActiveSheet.Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n        \'等待一段时间再执行\n        \'Application.Wait Now + TimeValue("00:00:01")\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n        \n          \n        \'CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"\n        \n        Selection.EntireColumn.Select\n            \n    \'对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:="Fail"\n    \n          \'Application.Wait Now + TimeValue("00:00:01")\n          \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 3).Select\n         \n        \n         \'ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         \n         Sheets(currentSheetName.Name).Range("a1").CurrentRegion.Select\n         \'复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         \'到最后一格空格处复制粘贴防止覆盖\n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n         \'Application.Wait Now + TimeValue("00:00:01")\n         \'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         \'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         \'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         \'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          \'选择有效数据\nnexttime:\nNext\n\n\n\n  \nEnd Sub\n\n\nFunction IsBlankSht(Sh As Variant) As Boolean\n      If TypeName(Sh) = "String" Then Set Sh = Worksheets(Sh)\n      If Application.CountA(Sh.UsedRange.Cells) = 0 Then\n          IsBlankSht = True\n      End If\n  End Function\n\n\n\n\n\n\nV17.1\n\n\n\'Private Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long)\nSub 宏1()\n\n\n\n\'添加注释\nApplication.ScreenUpdating = False\n\'\nApplication.DisplayAlerts = False\n  \n\' test2 宏\n\'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    Dim sheetCopyRange As String\n    Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    Dim colmunsCount As Integer\n    Dim rowsCount As Integer\n    \'fail result name\n    Dim FRN As String\n        \'判断是否存在failResult文件夹\n         FRN = "failResult"\n        s = "failResult"\n        Set judge = CreateObject("Scripting.Dictionary")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = ""\n        \n        \'判断是否有空表，有则删除\n        If Cells.Find("*") Is Nothing Then\n        Sheets(currentResultName.Name).Delete\n        End If\n        \n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        \'MsgBox "请创建一个名为failResult的工作表"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    \'新建一个sheet存放失败项\n   \'获取脚本数量\n   \' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n        \n        \n        \n    \n        \n        \'不对failResult进行操作\n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        End If\n        \n        \n        Sheets(currentSheetName.Name).Select\n        Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n        ActiveSheet.UsedRange.AutoFilter\n        \n        \n       \' MsgBox currentSheetName.Name\n        \n        \'获取表名字\n       \' fname = ActiveSheet.Name\n        \'搜索并确定result位置\n         ActiveSheet.Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n        \'等待一段时间再执行\n        \'Application.Wait Now + TimeValue("00:00:01")\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n        \n          \n        \'CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"\n        \n        Selection.EntireColumn.Select\n            \n    \'对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:="Fail"\n    \n          \'Application.Wait Now + TimeValue("00:00:01")\n          \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 3).Select\n         \n        \n         \'ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         \n         Sheets(currentSheetName.Name).Range("a1").CurrentRegion.Select\n         \'复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         \'到最后一格空格处复制粘贴防止覆盖\n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n         \'Application.Wait Now + TimeValue("00:00:01")\n         \'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         \'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         \'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         \'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          \'选择有效数据\nnexttime:\nNext\n\n\n\n  \nEnd Sub\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br"),n("span",{staticClass:"line-number"},[s._v("156")]),n("br"),n("span",{staticClass:"line-number"},[s._v("157")]),n("br"),n("span",{staticClass:"line-number"},[s._v("158")]),n("br"),n("span",{staticClass:"line-number"},[s._v("159")]),n("br"),n("span",{staticClass:"line-number"},[s._v("160")]),n("br"),n("span",{staticClass:"line-number"},[s._v("161")]),n("br"),n("span",{staticClass:"line-number"},[s._v("162")]),n("br"),n("span",{staticClass:"line-number"},[s._v("163")]),n("br"),n("span",{staticClass:"line-number"},[s._v("164")]),n("br"),n("span",{staticClass:"line-number"},[s._v("165")]),n("br"),n("span",{staticClass:"line-number"},[s._v("166")]),n("br"),n("span",{staticClass:"line-number"},[s._v("167")]),n("br"),n("span",{staticClass:"line-number"},[s._v("168")]),n("br"),n("span",{staticClass:"line-number"},[s._v("169")]),n("br"),n("span",{staticClass:"line-number"},[s._v("170")]),n("br"),n("span",{staticClass:"line-number"},[s._v("171")]),n("br"),n("span",{staticClass:"line-number"},[s._v("172")]),n("br"),n("span",{staticClass:"line-number"},[s._v("173")]),n("br"),n("span",{staticClass:"line-number"},[s._v("174")]),n("br"),n("span",{staticClass:"line-number"},[s._v("175")]),n("br"),n("span",{staticClass:"line-number"},[s._v("176")]),n("br"),n("span",{staticClass:"line-number"},[s._v("177")]),n("br"),n("span",{staticClass:"line-number"},[s._v("178")]),n("br"),n("span",{staticClass:"line-number"},[s._v("179")]),n("br"),n("span",{staticClass:"line-number"},[s._v("180")]),n("br"),n("span",{staticClass:"line-number"},[s._v("181")]),n("br"),n("span",{staticClass:"line-number"},[s._v("182")]),n("br"),n("span",{staticClass:"line-number"},[s._v("183")]),n("br"),n("span",{staticClass:"line-number"},[s._v("184")]),n("br"),n("span",{staticClass:"line-number"},[s._v("185")]),n("br"),n("span",{staticClass:"line-number"},[s._v("186")]),n("br"),n("span",{staticClass:"line-number"},[s._v("187")]),n("br"),n("span",{staticClass:"line-number"},[s._v("188")]),n("br"),n("span",{staticClass:"line-number"},[s._v("189")]),n("br"),n("span",{staticClass:"line-number"},[s._v("190")]),n("br"),n("span",{staticClass:"line-number"},[s._v("191")]),n("br"),n("span",{staticClass:"line-number"},[s._v("192")]),n("br"),n("span",{staticClass:"line-number"},[s._v("193")]),n("br"),n("span",{staticClass:"line-number"},[s._v("194")]),n("br"),n("span",{staticClass:"line-number"},[s._v("195")]),n("br"),n("span",{staticClass:"line-number"},[s._v("196")]),n("br"),n("span",{staticClass:"line-number"},[s._v("197")]),n("br"),n("span",{staticClass:"line-number"},[s._v("198")]),n("br"),n("span",{staticClass:"line-number"},[s._v("199")]),n("br"),n("span",{staticClass:"line-number"},[s._v("200")]),n("br"),n("span",{staticClass:"line-number"},[s._v("201")]),n("br"),n("span",{staticClass:"line-number"},[s._v("202")]),n("br"),n("span",{staticClass:"line-number"},[s._v("203")]),n("br"),n("span",{staticClass:"line-number"},[s._v("204")]),n("br"),n("span",{staticClass:"line-number"},[s._v("205")]),n("br"),n("span",{staticClass:"line-number"},[s._v("206")]),n("br"),n("span",{staticClass:"line-number"},[s._v("207")]),n("br"),n("span",{staticClass:"line-number"},[s._v("208")]),n("br"),n("span",{staticClass:"line-number"},[s._v("209")]),n("br"),n("span",{staticClass:"line-number"},[s._v("210")]),n("br"),n("span",{staticClass:"line-number"},[s._v("211")]),n("br"),n("span",{staticClass:"line-number"},[s._v("212")]),n("br"),n("span",{staticClass:"line-number"},[s._v("213")]),n("br"),n("span",{staticClass:"line-number"},[s._v("214")]),n("br"),n("span",{staticClass:"line-number"},[s._v("215")]),n("br"),n("span",{staticClass:"line-number"},[s._v("216")]),n("br"),n("span",{staticClass:"line-number"},[s._v("217")]),n("br"),n("span",{staticClass:"line-number"},[s._v("218")]),n("br"),n("span",{staticClass:"line-number"},[s._v("219")]),n("br"),n("span",{staticClass:"line-number"},[s._v("220")]),n("br"),n("span",{staticClass:"line-number"},[s._v("221")]),n("br"),n("span",{staticClass:"line-number"},[s._v("222")]),n("br"),n("span",{staticClass:"line-number"},[s._v("223")]),n("br"),n("span",{staticClass:"line-number"},[s._v("224")]),n("br"),n("span",{staticClass:"line-number"},[s._v("225")]),n("br"),n("span",{staticClass:"line-number"},[s._v("226")]),n("br"),n("span",{staticClass:"line-number"},[s._v("227")]),n("br"),n("span",{staticClass:"line-number"},[s._v("228")]),n("br"),n("span",{staticClass:"line-number"},[s._v("229")]),n("br"),n("span",{staticClass:"line-number"},[s._v("230")]),n("br"),n("span",{staticClass:"line-number"},[s._v("231")]),n("br"),n("span",{staticClass:"line-number"},[s._v("232")]),n("br"),n("span",{staticClass:"line-number"},[s._v("233")]),n("br"),n("span",{staticClass:"line-number"},[s._v("234")]),n("br"),n("span",{staticClass:"line-number"},[s._v("235")]),n("br"),n("span",{staticClass:"line-number"},[s._v("236")]),n("br"),n("span",{staticClass:"line-number"},[s._v("237")]),n("br"),n("span",{staticClass:"line-number"},[s._v("238")]),n("br"),n("span",{staticClass:"line-number"},[s._v("239")]),n("br"),n("span",{staticClass:"line-number"},[s._v("240")]),n("br"),n("span",{staticClass:"line-number"},[s._v("241")]),n("br"),n("span",{staticClass:"line-number"},[s._v("242")]),n("br"),n("span",{staticClass:"line-number"},[s._v("243")]),n("br"),n("span",{staticClass:"line-number"},[s._v("244")]),n("br"),n("span",{staticClass:"line-number"},[s._v("245")]),n("br"),n("span",{staticClass:"line-number"},[s._v("246")]),n("br"),n("span",{staticClass:"line-number"},[s._v("247")]),n("br"),n("span",{staticClass:"line-number"},[s._v("248")]),n("br"),n("span",{staticClass:"line-number"},[s._v("249")]),n("br"),n("span",{staticClass:"line-number"},[s._v("250")]),n("br"),n("span",{staticClass:"line-number"},[s._v("251")]),n("br"),n("span",{staticClass:"line-number"},[s._v("252")]),n("br"),n("span",{staticClass:"line-number"},[s._v("253")]),n("br"),n("span",{staticClass:"line-number"},[s._v("254")]),n("br"),n("span",{staticClass:"line-number"},[s._v("255")]),n("br"),n("span",{staticClass:"line-number"},[s._v("256")]),n("br"),n("span",{staticClass:"line-number"},[s._v("257")]),n("br"),n("span",{staticClass:"line-number"},[s._v("258")]),n("br"),n("span",{staticClass:"line-number"},[s._v("259")]),n("br"),n("span",{staticClass:"line-number"},[s._v("260")]),n("br"),n("span",{staticClass:"line-number"},[s._v("261")]),n("br"),n("span",{staticClass:"line-number"},[s._v("262")]),n("br"),n("span",{staticClass:"line-number"},[s._v("263")]),n("br"),n("span",{staticClass:"line-number"},[s._v("264")]),n("br"),n("span",{staticClass:"line-number"},[s._v("265")]),n("br"),n("span",{staticClass:"line-number"},[s._v("266")]),n("br"),n("span",{staticClass:"line-number"},[s._v("267")]),n("br"),n("span",{staticClass:"line-number"},[s._v("268")]),n("br")])]),n("p",[s._v("V18 11051635")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\'Private Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long)\nSub 宏1()\n\n\n\n\'添加注释\nApplication.ScreenUpdating = False\n\'\nApplication.DisplayAlerts = False\n  \n\' test2 宏\n\'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    \'Dim sheetCopyRange As String\n    \'Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    \'Dim colmunsCount As Integer\n    \'Dim rowsCount As Integer\n    \'fail result name\n    Dim FRN As String\n        \'判断是否存在failResult文件夹\n         FRN = "failResult"\n        s = "failResult"\n        Set judge = CreateObject("Scripting.Dictionary")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = ""\n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        \'MsgBox "请创建一个名为failResult的工作表"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    \'新建一个sheet存放失败项\n   \'获取脚本数量\n   \' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        End If\n       \n       \'判断表是否为空\n        If ShIsBlank(currentSheetName) = True Then\n            currentSheetName.Delete\n            GoTo nexttime\n        End If\n        \n        Sheets(currentSheetName.Name).Select\n        Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n        ActiveSheet.UsedRange.AutoFilter\n        \n        \n       \' MsgBox currentSheetName.Name\n        \n        \'获取表名字\n       \' fname = ActiveSheet.Name\n        \'搜索并确定result位置\n         ActiveSheet.Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n        \'等待一段时间再执行\n        \'Application.Wait Now + TimeValue("00:00:01")\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n        \n          \n        \'CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"\n        \n        Selection.EntireColumn.Select\n            \n    \'对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:="Fail"\n    \n          \'Application.Wait Now + TimeValue("00:00:01")\n          \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 3).Select\n         \n        \n         \'ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         \n         Sheets(currentSheetName.Name).Range("a1").CurrentRegion.Select\n         \'复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         \'到最后一格空格处复制粘贴防止覆盖\n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n         \'Application.Wait Now + TimeValue("00:00:01")\n         \'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         \'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         \'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         \'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          \'选择有效数据\nnexttime:\nNext\n\nMsgBox "所有失败项都已放置在failResult中"\n\nEnd Sub\n\nFunction ShIsBlank(sht As Variant) As Boolean\n    If TypeName(sht) = "string" Then\n        Set sht = Worksheets(sht) \'sht是工作表对象,完全可以作为Worksheets集合的参数加以利用.\n    End If\n    If Application.WorksheetFunction.CountA(sht.UsedRange.Cells) = 0 Then\n        ShIsBlank = True\n    End If\n   \nEnd Function\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br")])]),n("h1",{attrs:{id:"v19-00-11051659-keyong"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#v19-00-11051659-keyong"}},[s._v("#")]),s._v(" V19.00 11051659(keyong)")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\'Private Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long)\nSub 宏1()\n\n\n\n\'添加注释\nApplication.ScreenUpdating = False\n\'\nApplication.DisplayAlerts = False\n  \n\' test2 宏\n\'Dim sheetCount As Integer\nDim resultSheetName As String\n    Dim searchResultLocation As String\n    \'Dim sheetCopyRange As String\n    \'Dim sheetPasteRange As String\n    \n    Dim judge, currentSheetName As Excel.Worksheet, s$\n    \n    \'Dim colmunsCount As Integer\n    \'Dim rowsCount As Integer\n    \'fail result name\n    Dim FRN As String\n        \'判断是否存在failResult文件夹\n         FRN = "failResult"\n        s = "failResult"\n        Set judge = CreateObject("Scripting.Dictionary")\n        For Each currentResultName In Worksheets\n        judge(currentResultName.Name) = ""\n        Next\n        \n        If judge.exists(s) Then\n        GoTo begin\n        Else\n        \'MsgBox "请创建一个名为failResult的工作表"\n            Sheets.Add After:=ActiveSheet\n            Sheets(2).Select\n            Sheets(2).Name = FRN\n        End If\n        Set judge = Nothing\n        \nbegin:\n    \n    \'新建一个sheet存放失败项\n   \'获取脚本数量\n   \' sheetCount = Worksheets.CountNew\n    For Each currentSheetName In ThisWorkbook.Worksheets\n    \n        If currentSheetName.Name = FRN Then\n        GoTo nexttime\n        End If\n       \n       \'判断表是否为空\n        If ShIsBlank(currentSheetName) = True Then\n            currentSheetName.Delete\n            GoTo nexttime\n        End If\n        \n        Sheets(currentSheetName.Name).Select\n        Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Select\n        ActiveSheet.UsedRange.AutoFilter\n        \n        \n       \' MsgBox currentSheetName.Name\n        \n        \'获取表名字\n        fname = ActiveSheet.Name\n        \'搜索并确定result位置\n         ActiveSheet.Cells.Find(What:="Result", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, MatchByte:=False, SearchFormat:=False).Activate\n        \'等待一段时间再执行\n        \'Application.Wait Now + TimeValue("00:00:01")\n          searchResultLocation = ActiveCell.Address(0, 0)\n          \n        \n          \n        \'CONSTCOLUMNS = Left(searchResultLocation, 1) + "800"\n        \n        Selection.EntireColumn.Select\n            \n    \'对选中数据进行筛选\n    Selection.AutoFilter\n    ActiveSheet.Range(searchResultLocation).End(xlDown).AutoFilter Field:=1, Criteria1:="Fail"\n    \n          \'Application.Wait Now + TimeValue("00:00:01")\n          \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 3).Select\n         \n        \n         \'ActiveSheet.Cells.SpecialCells(xlCellTypeConstants).Select\n         \n         Sheets(currentSheetName.Name).Range("a1").CurrentRegion.Select\n         \'复制粘贴到新的表\n         Selection.Copy\n         Sheets(FRN).Select\n         \'到最后一格空格处复制粘贴防止覆盖\n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 3).Select\n         \n         \n         \'Application.Wait Now + TimeValue("00:00:01")\n         \'Rows(ActiveSheet.UsedRange.Rows.Count).Insert\n         \n         ActiveSheet.Paste\n         \n         Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 2).Value = "上一个工作表的名字：" + Sheets(currentSheetName.Name).Name\n          \n         \'Range("a" & Cells(Rows.Count, 1).End(xlUp).Row + 1).Select\n         \n         \'colmunsCount = ActiveSheet.UsedRange.Columns.Count\n         \'rowsCount = ActiveSheet.UsedRange.Rows.Count\n         \n         \n         \'ActiveSheet(failResult).Range().Values = currentSheetName\n         \n         \n          \'选择有效数据\nnexttime:\nNext\n\nMsgBox "所有失败项都已放置在failResult中"\n\nEnd Sub\n\n\n\n\n\nFunction ShIsBlank(sht As Variant) As Boolean\n    If TypeName(sht) = "string" Then\n        Set sht = Worksheets(sht) \'sht是工作表对象,完全可以作为Worksheets集合的参数加以利用.\n    End If\n    If Application.WorksheetFunction.CountA(sht.UsedRange.Cells) = 0 Then\n        ShIsBlank = True\n    End If\n   \nEnd Function\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);